<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>风险评测</title>
    <meta name="keywords" content="金谷财行,产业链金融,产业链平台,金谷财行官网">
    <meta name="description" content="金谷财行官方网站提供金谷财行最新动态,产品详情.金谷财行是专业的产业链金融平台,注册资本8000万,以云谷相关产业链上下游客户为中心,定位产业链生态圈,服务于实体产业.金谷财行-专业的产业链金融平台.">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, user-scalable=no">
    <meta name="apple-mobile-web-app-title" content="">
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>
    <meta name="format-detection" content="telephone=no, email=no"/>
    <meta name="MobileOptimized" content="320">
    <meta name="screen-orientation" content="portrait">
    <meta name="x5-orientation" content="portrait">
    <meta name="full-screen" content="yes">
    <meta name="x5-fullscreen" content="true">
    <script src="js/flexible.js"></script>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/swiper-3.4.2.min.css">
    <style>
        article{padding: 0.266667rem 0;background-color: #f5f5f5;}
        .h3{padding: 0 0.533333rem;font-size: 0.346667rem;color: #333;line-height: .4rem;}
        p{padding: 0 0.533333rem;text-indent: 2em;font-size: 0.346667rem;color: #333;line-height: .5rem;}
        .pd30{padding: 0.4rem 0.533333rem;}
        .begin{display: block;margin: 0.666667rem 0.533333rem;padding: 0.266667rem 0;text-align: center;color: #fff;background-color: #ef6c2d;border-radius: 5px;}
        .begin.again{background-color: #e7e7e7;color: #999;}
        .pages{margin:0.533333rem;clear: both;overflow-y: hidden;}
        .prev-page{display: inline-block;float: left;font-size: 0.346667rem;color: #ef6c2d;}
        .total-page{display: inline-block;float: right;font-size: 0.32rem;color: #999;}
        .checked{display: inline-block;float: left;width: 0.373333rem;margin-right: 0.2rem;height: 0.373333rem;border:1px solid #484848;border-radius: 50%;}
        dl{background-color: #fff;}
        dt{padding: 0.466667rem;font-size: 0.373333rem;color: #333;font-weight: bold;background-color: #f9f9f9;}
        dd{margin: 0 0.466667rem;padding: 0.466667rem 0 0.466667rem 0.266667rem;background-color: #fff;border-top: 1px solid #fff;border-bottom: 1px solid #fff;}
        dd.active{border-top: 1px solid #e7e7e7;border-bottom: 1px solid #e7e7e7;background-color: #f9f9f9;}
        dd.active .checked{border:1px solid #ef6c2d;background-color: #ef6c2d;box-shadow: 0 0 0 0.08rem #fff inset;}
        .result-icon{width: 1.586667rem;height: 0.173333rem;margin:0.2rem auto;background: #fff url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHcAAAANCAMAAACkXgEfAAAAOVBMVEUAAADX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19emE30cAAAAEnRSTlMAGxHt5+HZ0YaAeXFpNS0ku7gEG5iZAAAAbUlEQVQ4y8XTOQ6EQAxE0d/ufYe5/2FHQogYOTAvqYrsqNCbp/CB5Ut2mNthUJP5Yxc70OLGlKR2ZQ8LQ5Lr3YafqPze43GUp5ZDd0tl+nG3mgVDK/QrWxJM7diAHu2HlCojbMy5XPziA3JO1P4F/wg1apT8vQAAAABJRU5ErkJggg==) center center no-repeat;background-size: 100%;}
        .result{text-align: center;background-color: #fff;}
        .result-title{padding: 0.8rem 0 0; font-size: 0.346667rem;color: #333;}
        .result-type{font-size: 0.44rem;color: #333;font-weight: bold;}
        .result img{display: block;width: 60%;height: 100%;margin: 0.666667rem auto;}
        .dn{display: none;}
    </style>
</head>
<body>
    <article>
        <div class="swiper-container">
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <h3 class="h3">尊敬的投资者：</h3>
                    <p class="">非常感谢您关注金谷财行为您提供的投资产品，在您确定投资前，请协助回答下列问题，以下问题将根据您的年龄情况、财务状况、投资经验、投资目的、收益预期、风险偏好、流动性要求、风险认知和风险承受损失程度对您进行风险承受能力测评，测评结果将有助于分析您对金融工具及投资目标的相关风险的态度。该风险测评问卷的有效期为一年，超过一年请您通过本网站重新测评自身风险承受能力。此外，若发生可能影响自身风险承受能力（尤其是本问卷涉及的各项内容）的情况，请您通过本网站主动重新测评自身风险承受能力。</p>
                    <p>本公司在此承诺，对于您在本问卷中所提供的一切信息，本公司将严格按照法律法规要求承担保密义务。除法律法规规定的有权机关依法定程序进行查询以外，本公司保证不会将涉及您的任何信息提供、泄露给任何第三方，或者将相关信息用于违法、不当用途。</p>
                    <p>本测评问卷内容及结果系根据您填问卷当时所提供的个人资料而推论得知，且其结果将作为您未来在本公司投资时的参考所用。此问卷内容及其结果不构成与您进行交易之要约或要约之引诱，亦非投资买卖建议。本公司将不会对此份问卷之准确性及咨询是否完整负责。您在此问卷上所填的个人资料本公司将予以保密。</p>
                    <a href="javascript:;" class="begin">开始测评</a>
                </div>
                <div class="swiper-slide" id="quesListContent">
                    <div class="result" id="restContent">
                    </div>
                </div>
            </div>
        </div>
    </article>
<script src="js/zepto.min.js"></script>
<script src="js/swiper.min.js"></script>
<script src="./js/jquery_1.11.0.min.js"></script>
<script src="/static/js/config.js"></script>
<script src="/static/js/cookie.js"></script>
<script src="/static/js/md5.js"></script>
<script src="/static/js/ajaxPrams.js"></script>
<script>
    var totalScore = 0;
    var mySwiper =null;

    function next(obj, index,len){
//        totalScore += parseInt($(obj).attr('data-score'));
//        console.log(totalScore)

        $(obj).addClass('active').siblings().removeClass('active');
        if(index < len) mySwiper.slideNext();
    }

    $(function(){
        //此处先判断是否已经评测过
        var myParams = getParams();
        $.ajax({
            url:BASE_URL + '/api/web/riskAppraisal/myAppraisal',
            type:'post',
            data:myParams,
            dataType:'json',
            success:function(data){
                var  content = "";
                if(data.code == 100 && data.data.typeName ){
                    content+='<div class="result-title">您的风险测评结果为</div>';
                    content+='<div class="result-icon"></div>';
                    content+='<div class="result-type">'+data.data.typeName+'</div>';
                    content+='<img src="img/risk/result.jpg" alt="">';
                    content+='<div class="result-score">总分数：'+data.data.score+'分</div>';
                    if(data.data.score <= 29){
                        content+='<div class="result-level">适合您的投资产品评级：低风险</div>';
                    }else if(data.data.score <= 45 && data.data.score >= 30){
                        content+='<div class="result-level">适合您的投资产品评级：中低风险</div>';
                    }else if(data.data.score <= 60 && data.data.score >= 46){
                        content+='<div class="result-level">适合您的投资产品评级：中风险</div>';
                    }else if(data.data.score <= 75 && data.data.score >= 61){
                        content+='<div class="result-level">适合您的投资产品评级：中高风险</div>';
                    }else if(data.data.score >= 76){
                        content+='<div class="result-level">适合您的投资产品评级：高风险</div>';
                    }else{
                        content+='<div class="result-level">适合您的投资产品评级：分值等级有误,请联系管理员</div>';
                    }
                    content+='<a href="javascript:void(0);" onclick="toProductsList();" class="begin">去看看适合我的产品</a>';
                    content+='<a href="javascript:void(0);" onclick="reRest();" class="begin again">重新评测</a>';
                    content+='<div class="result-time">本次测评结果有效期：'+data.data.endTime.substring(0,10)+'</div>';
                    $("#restContent").html(content);
                    mySwiper = new Swiper('.swiper-container', {
                        speed: 300
                    });
                    mySwiper.slideTo(2, 10, false);
                }
            }
        });
    });

    $('.begin').click(function(){
        //此处ajax
        var myParams = getParams();
        myParams.pageSize = 200;
         $.ajax({
             url:BASE_URL + '/api/web/riskAppraisal/riskAppraisalList',
             type:'post',
             dataType:'json',
             data:myParams,
             success:function(data){
                 var quesListContent = "";
                 if(data.code == 100){
                     $.each(data.data,function(i,n){
                         quesListContent +='<div class="swiper-slide is-had">';
                         if(i==0){
                             quesListContent +='<p class="pd30">任何收益总是伴随着相应的风险，而风险评测能够使您的申购处于风险承受能力范围之内；同时金谷财行会根据您的风险偏好，给出合理的建议，只有13道题，快来开始风险评估吧！</p>';
                         }
                         quesListContent +='<dl>';
                         quesListContent +='<dt>'+n.question.questionSort+'、'+n.question.questionTitle+'</dt>';
                         $.each(n.answer,function (j,k) {
                             quesListContent +='<dd onclick="next(this,'+i+','+(data.data.length-1)+')" data-score="'+k.answerScore+'"><span class="checked"></span>'+k.answerValue+'</dd>';
                         })
                         quesListContent +='</dl>';
                         quesListContent +='<div class="pages">';
                         if(i>0){
                             quesListContent +='<span class="prev-page">上一题</span>';
                         }
                         quesListContent +='<span class="total-page">'+(i+1)+'/'+data.data.length+'</span></div>';
                         quesListContent +='<a href="javascript:void(0);" onclick="saveRist()"';
                         if(Number(i+1)== Number(data.data.length)){
                             quesListContent +='class="begin"';
                         }else{
                             quesListContent +='class="dn"';
                         }
                         quesListContent +='>提交测评</a></div>';
                     });
                     $("#quesListContent").before(quesListContent);
                     mySwiper = new Swiper('.swiper-container', {
                         speed: 300
                     });

                     $('.prev-page').on('click',function(){
                         if(mySwiper.realIndex == 0){
                             totalScore = 0;
                         }
                        
                        // 去掉"上一题"选中的样式，然而要显示选中的样式...
                        //  $('.swiper-slide-prev').find('dd').removeClass('active');

                         mySwiper.slidePrev();
                     });
                     //干完之后切换到结果页
                     mySwiper.slideNext();
                 }
             }
         });
    });

    function saveRist() {
        var myParams = getParams();
        $('.swiper-slide .active').each(function(){
            totalScore += parseInt($(this).attr('data-score'));
        })
        myParams.answerId = totalScore;
        $.ajax({
            url:BASE_URL + '/api/web/riskAppraisal/saveAppraisalRecord',
            type:'post',
            data:myParams,
            dataType:'json',
            success:function(data){
                var  content = "";
                if(data.code == 100 && data.data.typeName){
                    content+='<div class="result-title">您的风险测评结果为</div>';
                    content+='<div class="result-icon"></div>';
                    content+='<div class="result-type">'+data.data.typeName+'</div>';
                    content+='<img src="img/risk/result.jpg" alt="">';
                    content+='<div class="result-score">总分数：'+data.data.score+'分</div>';
                    if(data.score <= 29){
                        content+='<div class="result-level">适合您的投资产品评级：低风险</div>';
                    }else if(data.data.score <= 45 && data.data.score >= 30){
                        content+='<div class="result-level">适合您的投资产品评级：中低风险</div>';
                    }else if(data.data.score <= 60 && data.data.score >= 46){
                        content+='<div class="result-level">适合您的投资产品评级：中风险</div>';
                    }else if(data.data.score <= 75 && data.data.score >= 61){
                        content+='<div class="result-level">适合您的投资产品评级：中高风险</div>';
                    }else if(data.data.score >= 76){
                        content+='<div class="result-level">适合您的投资产品评级：高风险</div>';
                    }else{
                        content+='<div class="result-level">适合您的投资产品评级：分值等级有误,请联系管理员</div>';
                    }
                    content+='<a href="javascript:;" onclick="toProductsList();" class="begin">去看看适合我的产品</a>';
                    content+='<a href="javascript:;" onclick="reRest();" class="begin again">重新评测</a>';
                    content+='<div class="result-time">本次测评结果有效期：'+data.data.endTime.substring(0,10)+'</div>';
                    $("#restContent").html(content);
                    //干完之后切换到结果页
                    mySwiper.slideNext();
                }
            }
        });
    }

    function reRest() {
        var myParams = getParams();
        totalScore = 0;
        myParams.pageSize = 200;
        $('.is-had').remove();
        $.ajax({
            url:BASE_URL + '/api/web/riskAppraisal/riskAppraisalList',
            type:'post',
            data:myParams,
            dataType:'json',
            success:function(data){
                var quesListContent = "";
                if(data.code == 100){
                    $.each(data.data,function(i,n){
                        quesListContent +='<div class="swiper-slide is-had">';
                        var temp = '';
                        if(i==0){
                            quesListContent +='<p class="pd30">任何收益总是伴随着相应的风险，而风险评测能够使您的申购处于风险承受能力范围之内；同时金谷财行会根据您的风险偏好，给出合理的建议，只有13道题，快来开始风险评估吧！</p>';
                        }
                        quesListContent +='<dl>';
                        quesListContent +='<dt>'+n.question.questionSort+'、'+n.question.questionTitle+'</dt>';
                        $.each(n.answer,function (j,k) {
                            quesListContent +='<dd onclick="next(this,'+i+','+(data.data.length-1)+')" data-score="'+k.answerScore+'"><span class="checked"></span>'+k.answerValue+'</dd>';
                        })
                        quesListContent +='</dl>';
                        quesListContent +='<div class="pages">';
                        if(i>0){
                            quesListContent +='<span class="prev-page">上一题</span>';
                        }
                        quesListContent +='<span class="total-page">'+(i+1)+'/'+data.data.length+'</span></div>';
                        quesListContent +='<a href="javascript:void(0);" onclick="saveRist()"';
                        if(Number(i+1)== Number(data.data.length)){
                            quesListContent +='class="begin"';
                        }else{
                            quesListContent +='class="dn"';
                        }
                        quesListContent +='>提交测评</a></div>';
                    });
                    $("#quesListContent").before(quesListContent);
                    mySwiper = new Swiper('.swiper-container', {
                        speed: 300
                    });
                    $('.prev-page').on('click',function(){
                        if(mySwiper.realIndex == 0){
                            totalScore = 0;
                        }
                        $('.swiper-slide-prev').find('dd').removeClass('active');

                        mySwiper.slidePrev();
                    });
                    //干完之后切换到结果页
                    mySwiper.slideNext();
                }
            }
        });
    }
    function toProductsList() {
        var clientType = GetQueryString("clientType");
        if(clientType == 4){
            window.jstomobile.toProductList();
        }else if(clientType == 5){
            toProductList();
        }
    }
</script>
</body>
</html>
